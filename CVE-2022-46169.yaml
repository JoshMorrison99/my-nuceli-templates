id: CVE-2022-46169

info:
  name: CVE-2022-46169 Cacti - Command Injection
  author: shelled
  severity: high
  description: |
    CVE-2022-46169 Cacti remote_agent.php Unauthenticated Command Injection.
  reference:
    - https://github.com/0xf4n9x/CVE-2022-46169
  tags: cve2022,cacti,cmdi,github,cve

requests:
  - raw:
    - |
      GET /cacti/remote_agent.php?action=polldata&poller_id=1&host_id=1&local_data_ids[]=1 HTTP/1.1
      Host: {{Hostname}}
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0
    
    attack: batteringram
    payloads:
      fuzz:
        

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "FATAL: You are not authorized to use this service"
